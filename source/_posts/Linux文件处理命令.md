---
title: Linux 文件的排序、合并和分割
comments: false
excerpt: Linux 文件的排序、合并和分割
categories:
  - - Linux
tags:
  - Linux
toc: true
math: true
reward: false
top: false
date: 2022-05-26 16:43:15
---

## `sort`命令

`sort` 命令将输入文件看作由多条记录组成的数据流，而记录由可变宽度的字段组成，***记录由换行符作为界定符***。`sort`命令与`awk`一样，可将记录分成多个域进行处理，***默认的域分隔符是空格符***。`sort`命令的基本格式为：

```shell
sort [选项] [输入文件]
```

### `sort`命令的选项

下面是`sort`命令的选项及其意义：

|     选项     |                         意义                         |
| :----------: | :--------------------------------------------------: |
|      -c      |                测试文件是否已经排序。                |
|      -k      |                    指定排序的域。                    |
|      -m      |                合并两个已排序的文件。                |
|      -n      |                根据数字大小进行排序。                |
| -o[输出文件] | 将输出写到指定文件，相当于将输出重定向到指定为文件。 |
|      -r      |                 将排序结果逆向显示。                 |
|      -t      |                    改变域分隔符。                    |
|      -u      |                 去除结果中的重复行。                 |

### `sort`命令的基本用法

`sort`命令是分域对文件进行排序的，默认的域分隔符是空格符，`-t`选项可用于设置分隔符。

1. `sort`命令用`-t`选项设置分隔符：

   ```
   # 使用冒号作为域分隔符，注意 -t 与冒号之间是没有分隔符的。
   sort -t: stuscort.txt
   ```

   `sort`命令默认根据第一域对数据进行排序，如果第一域相同，再根据第二域进行排序，以此类推。当未指定`-t`时，分隔符是空格，这时记录内开头与结尾的空格都将被忽略；当`-t`选项改变分隔符时，空格符变得有意义。如`[空格符]:root:[空格符]`这条记录，在未指定`-t`时，这条记录只有一个域`:root:`，记录前后的空格符都被忽略了；若将`-t`选项指定为冒号，这条记录就包含了三个域，第一和第三域都是空格符，第二域是`:root:`;

2. `sort`命令用`-k`选项指定排序的域号：

   ```shell
   # 根据第三域对stuscore进行排序
   sort -t: -k3 stuscore
   ```

   在上例中利用`-k`选项指定了`sort`命令根据第三域进行排序，注意`-k`和`3`之间也没有空格。如果第三域是数字，`sort`命令默认也不会以数字大小来排序，而是仍然以字符串的方式进行排序的。

3. `sort`命令用`-n`选项设置根据数值大小排序：

   ```shell
   sort -t: -k3n stuscore
   ```

   `-n`选项可以指定根据数字大小进行排序，`-n`选项不是单独使用的，一般放在域号之后。

4. `sort`命令用`-r`选项将排序结果逆向：

   ```shell
   sort -t: -k3rn stuscore
   ```

   `-r`选项用于将排序结果逆向显示。

5. `sort`命令`-u`选项的用法：

   ```shell
   # -u选项用于去除排序结果中的重复行
   sort -t: -u score
   ```

   `sort`命令在文件有未排序的记录时会有提示信息，如果文件已排序，则不会有任何提示信息。

6. `sort`命令`-m`选项的用法：

   `-m`选项用于将两个排好序的文件合并成一个排好序的文件，在文件合并前他们必须已经排好序。`-m`选项对未排序的文件进行合并没有任何意义。

   ```shell
   sort -t: -m stu1 stu2
   ```

   `-m`选项会将两个排好序的文件有序的插入到第二个文件的记录中。

## `uniq`命令

`uniq`命令用于去除文本文件中的重复行。`uniq`命令类似于`sort`命令的`-u`选项。不同的地方在于`uniq`命令只能去除连续的重复行，重复行之间不能夹杂其他的行，而`sort`命令的`-u`选项是去除所有的重复行。

### `uniq`命令的选项

| 选项 |                     意义                     |
| :--: | :------------------------------------------: |
|  -c  |       打印每行在文本中重复出现的次数。       |
|  -d  | 只显示有重复的记录，每个重复记录只出现一次。 |
|  -u  |            只显示没有重复的记录。            |

## `join`命令

`join`命令用于实现两个文件中记录的连接操作，连接操作是将两个文件中具有相同域的记录选择出来，再将这些记录所有的域放到一行（包含来自两个文件的所有域）。 

### `join`命令选项及其意义

|   选项   |                             意义                             |
| :------: | :----------------------------------------------------------: |
| -a1或-a2 | 除了显示以共同域进行连接的的结果外，-a1表示还显示第一个文件中没有共同域的记录，-a2则表示显示第二个文件中没有共同域的记录。 |
|    -i    |                比较域内容时，忽略大小写差异。                |
|    -o    |                     设置结果显示的格式。                     |
|    -t    |                        改变域分隔符。                        |
| -v1或-v2 |      与a选项类似，但是，不显示以共同域进行连接的结果。       |
|  -1或-2  |  -1用于设置文件1用于连接的域，-2用于设置文件2用于连接的域。  |

`join`命令默认显示连接记录在两个文件中的所有域，而且是按顺序来显示的。`-o`选项用于改变结果显示的格式：

```shell
# -o选项用于改变结果显示格式，在下面的命令中按第一个文件的第一个域、第二个文件中的第二个域和第一个文件中的第二个域进行显示
join -t: -o1.1 2.2 1.2 stu1 stu2
# -1 -2选项用于设置文件连接的域,下面的命令按第一个文件的第三个域与第二个文件的第一个域进行连接
join -t: -i -1 3 -2 1 stu1 stu2 
```

`join`命令在对两个文件进行连接操作时，两个文件必须都是按域排序好的，按其他域排序是无效的。

## `cut`命令

`cut`命令用于从标准输入或文本文件中按域或行提取文本。

### `cut`命令的选项

| 选项 |             意义             |
| :--: | :--------------------------: |
|  -c  | 指定提取的字符数或字符范围。 |
|  -f  |   指定提取的域数或域范围。   |
|  -d  |        改变域分隔符。        |

`-c`选项后跟数字表示字符数或字符范围，共有三种表示方式：

- `-cn`表示第`n`个字符。
- `-cn,m`表示第`n`个字符和第`m`个字符。
- `-cn-m`表示第`n`个字符到第`m`个字符。

由于`-c`选项是按字符提取文本的，因此，无需使用`-d`改变域分隔符，但是当使用`-f`按域提取文本时就需要使用`-d`改变域分隔符了。

## `paste`命令

`paste`命令用于将文本文件或标准输出中的内容粘贴到新的文件。

### `paste`命令的选项

| 选项 |                        意义                         |
| :--: | :-------------------------------------------------: |
|  -d  | 默认域分隔符是空格或Tab键，-d用于设置新的域分隔符。 |
|  -s  |               将每个文件粘贴成一行。                |

## `tar`命令

`tar`命令是Linux的归档命令，通俗地说，`tar`命令实现了Linux系统文件的压缩和解压缩。

### `tar`命令常用的选项

| 选项 |                             意义                             |
| :--: | :----------------------------------------------------------: |
| `-c` |                         创建新的包。                         |
| `-r` |                      为包添加新的文件。                      |
| `-t` |                        列出包的内容。                        |
| `-u` |    更新包中的文件，若包中无此文件，则将该文件添加到包中。    |
| `-x` |                         解压缩文件。                         |
| `-f` |           使用压缩文件或设备，该选项通常是必选的。           |
| `-v` |                详细报告`tar`处理文件的信息。                 |
| `-z` | 用`gzip`压缩和解压缩文件，若加上此选项创建压缩包，那么解压缩时也需要加上此选项。 |

在Linux 系统下有很多种压缩包格式，如`.tar`、`.gz`、`.tar.gz`、`.tgz`和`.Z`，利用`tar`命令解压缩时，常用的有两条命令：

```
# 解压缩非gzip格式的压缩包
tar -xvf 压缩包名称
# 解压gzip格式的压缩包
tar -zxvf 压缩包名称
```

`gzip`命令是Linux系统中常用的压缩工具，他可以对`tar`命令创建的压缩包进行压缩
